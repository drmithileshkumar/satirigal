{"version":3,"file":"_server-9689e172.js","sources":["../../../.svelte-kit/adapter-node/entries/endpoints/api/upload/_server.js"],"sourcesContent":["import { readFileSync, existsSync, mkdirSync, writeFileSync } from \"fs\";\nimport { e as error } from \"../../../../chunks/index.js\";\nasync function GET({ request, url }) {\n  const path = url.searchparams.get(\"path\");\n  const imageData = readFileSync(path, { encoding: \"utf8\", flag: \"r\" });\n  return new Response(JSON.stringify({ imageData }), {\n    headers: {\n      \"Content-Type\": \"image/svg\"\n    }\n  });\n}\nasync function POST({ locals, request }) {\n  if (!locals.user) {\n    return error(401, \"Unauthorized\");\n  }\n  const publicID = locals.user.publicID;\n  try {\n    const data = await request.json();\n    const name = data[\"name\"];\n    const file = data[\"image\"];\n    const folder = data[\"folder\"];\n    const encoding = data[\"encoding\"];\n    let dir = folder + \"/\" + publicID;\n    if (!existsSync(dir)) {\n      mkdirSync(dir);\n    }\n    writeFileSync(dir + `/${name}`, file, encoding);\n    return new Response(\"Uploaded\", { status: 200 });\n  } catch (err) {\n    return error(500, \"Failed\");\n  }\n}\nexport {\n  GET,\n  POST\n};\n"],"names":[],"mappings":";;;AAEA,eAAe,GAAG,CAAC,EAAE,OAAO,EAAE,GAAG,EAAE,EAAE;AACrC,EAAE,MAAM,IAAI,GAAG,GAAG,CAAC,YAAY,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;AAC5C,EAAE,MAAM,SAAS,GAAG,YAAY,CAAC,IAAI,EAAE,EAAE,QAAQ,EAAE,MAAM,EAAE,IAAI,EAAE,GAAG,EAAE,CAAC,CAAC;AACxE,EAAE,OAAO,IAAI,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,SAAS,EAAE,CAAC,EAAE;AACrD,IAAI,OAAO,EAAE;AACb,MAAM,cAAc,EAAE,WAAW;AACjC,KAAK;AACL,GAAG,CAAC,CAAC;AACL,CAAC;AACD,eAAe,IAAI,CAAC,EAAE,MAAM,EAAE,OAAO,EAAE,EAAE;AACzC,EAAE,IAAI,CAAC,MAAM,CAAC,IAAI,EAAE;AACpB,IAAI,OAAO,KAAK,CAAC,GAAG,EAAE,cAAc,CAAC,CAAC;AACtC,GAAG;AACH,EAAE,MAAM,QAAQ,GAAG,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC;AACxC,EAAE,IAAI;AACN,IAAI,MAAM,IAAI,GAAG,MAAM,OAAO,CAAC,IAAI,EAAE,CAAC;AACtC,IAAI,MAAM,IAAI,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC;AAC9B,IAAI,MAAM,IAAI,GAAG,IAAI,CAAC,OAAO,CAAC,CAAC;AAC/B,IAAI,MAAM,MAAM,GAAG,IAAI,CAAC,QAAQ,CAAC,CAAC;AAClC,IAAI,MAAM,QAAQ,GAAG,IAAI,CAAC,UAAU,CAAC,CAAC;AACtC,IAAI,IAAI,GAAG,GAAG,MAAM,GAAG,GAAG,GAAG,QAAQ,CAAC;AACtC,IAAI,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,EAAE;AAC1B,MAAM,SAAS,CAAC,GAAG,CAAC,CAAC;AACrB,KAAK;AACL,IAAI,aAAa,CAAC,GAAG,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC,EAAE,IAAI,EAAE,QAAQ,CAAC,CAAC;AACpD,IAAI,OAAO,IAAI,QAAQ,CAAC,UAAU,EAAE,EAAE,MAAM,EAAE,GAAG,EAAE,CAAC,CAAC;AACrD,GAAG,CAAC,OAAO,GAAG,EAAE;AAChB,IAAI,OAAO,KAAK,CAAC,GAAG,EAAE,QAAQ,CAAC,CAAC;AAChC,GAAG;AACH;;;;"}