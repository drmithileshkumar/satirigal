{"version":3,"file":"_server-1f88c8b4.js","sources":["../../../.svelte-kit/adapter-node/entries/endpoints/api/search/_server.js"],"sourcesContent":["import { g as getDBCollection } from \"../../../../chunks/mongo.js\";\nimport \"mongodb\";\nimport \"../../../../chunks/index.js\";\nasync function GET({ request, params, url, locals }) {\n  let searchKey = url.searchParams.get(\"searchKey\");\n  let value = url.searchParams.get(\"value\");\n  let users = [], userDetails = [];\n  if (!searchKey || !value)\n    return new Response(JSON.stringify(users));\n  let usersCollection = await getDBCollection(\"users\");\n  let userDetailCollection = await getDBCollection(\"userDetails\");\n  if (searchKey === \"name\") {\n    users = await usersCollection.find({ name: value }).toArray();\n  }\n  if (searchKey === \"publicID\") {\n    users = await usersCollection.find({ publicID: value }).toArray();\n  }\n  if (users.length > 0) {\n    for (let i = 0; i < users.length; i++) {\n      let newUserDetail = await userDetailCollection.findOne({ publicID: users[i].publicID });\n      userDetails.push(newUserDetail);\n    }\n  }\n  if (searchKey === \"city\") {\n    userDetails = await userDetailCollection.find({ \"common.city\": value }).toArray();\n    if (!userDetails)\n      userDetails = [];\n    for (let i = 0; i < userDetails.length; i++) {\n      let newUser = await usersCollection.findOne({ publicID: userDetails[i].publicID });\n      if (newUser) {\n        users.push(newUser);\n      }\n    }\n  }\n  let searchResult = [];\n  for (let i = 0; i < users.length; i++) {\n    searchResult.push(\n      {\n        name: users[i].name,\n        publicID: users[i].publicID,\n        profile: users[i].profile,\n        banner: users[i].banner,\n        bio: userDetails[i].common.bio\n      }\n    );\n  }\n  return new Response(JSON.stringify(searchResult), { status: 200 });\n}\nexport {\n  GET\n};\n"],"names":[],"mappings":";;;;AAGA,eAAe,GAAG,CAAC,EAAE,OAAO,EAAE,MAAM,EAAE,GAAG,EAAE,MAAM,EAAE,EAAE;AACrD,EAAE,IAAI,SAAS,GAAG,GAAG,CAAC,YAAY,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;AACpD,EAAE,IAAI,KAAK,GAAG,GAAG,CAAC,YAAY,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;AAC5C,EAAE,IAAI,KAAK,GAAG,EAAE,EAAE,WAAW,GAAG,EAAE,CAAC;AACnC,EAAE,IAAI,CAAC,SAAS,IAAI,CAAC,KAAK;AAC1B,IAAI,OAAO,IAAI,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC,CAAC;AAC/C,EAAE,IAAI,eAAe,GAAG,MAAM,eAAe,CAAC,OAAO,CAAC,CAAC;AACvD,EAAE,IAAI,oBAAoB,GAAG,MAAM,eAAe,CAAC,aAAa,CAAC,CAAC;AAClE,EAAE,IAAI,SAAS,KAAK,MAAM,EAAE;AAC5B,IAAI,KAAK,GAAG,MAAM,eAAe,CAAC,IAAI,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,CAAC,CAAC,OAAO,EAAE,CAAC;AAClE,GAAG;AACH,EAAE,IAAI,SAAS,KAAK,UAAU,EAAE;AAChC,IAAI,KAAK,GAAG,MAAM,eAAe,CAAC,IAAI,CAAC,EAAE,QAAQ,EAAE,KAAK,EAAE,CAAC,CAAC,OAAO,EAAE,CAAC;AACtE,GAAG;AACH,EAAE,IAAI,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;AACxB,IAAI,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;AAC3C,MAAM,IAAI,aAAa,GAAG,MAAM,oBAAoB,CAAC,OAAO,CAAC,EAAE,QAAQ,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;AAC9F,MAAM,WAAW,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;AACtC,KAAK;AACL,GAAG;AACH,EAAE,IAAI,SAAS,KAAK,MAAM,EAAE;AAC5B,IAAI,WAAW,GAAG,MAAM,oBAAoB,CAAC,IAAI,CAAC,EAAE,aAAa,EAAE,KAAK,EAAE,CAAC,CAAC,OAAO,EAAE,CAAC;AACtF,IAAI,IAAI,CAAC,WAAW;AACpB,MAAM,WAAW,GAAG,EAAE,CAAC;AACvB,IAAI,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,WAAW,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;AACjD,MAAM,IAAI,OAAO,GAAG,MAAM,eAAe,CAAC,OAAO,CAAC,EAAE,QAAQ,EAAE,WAAW,CAAC,CAAC,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC;AACzF,MAAM,IAAI,OAAO,EAAE;AACnB,QAAQ,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;AAC5B,OAAO;AACP,KAAK;AACL,GAAG;AACH,EAAE,IAAI,YAAY,GAAG,EAAE,CAAC;AACxB,EAAE,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;AACzC,IAAI,YAAY,CAAC,IAAI;AACrB,MAAM;AACN,QAAQ,IAAI,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI;AAC3B,QAAQ,QAAQ,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,QAAQ;AACnC,QAAQ,OAAO,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,OAAO;AACjC,QAAQ,MAAM,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,MAAM;AAC/B,QAAQ,GAAG,EAAE,WAAW,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,GAAG;AACtC,OAAO;AACP,KAAK,CAAC;AACN,GAAG;AACH,EAAE,OAAO,IAAI,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,EAAE,EAAE,MAAM,EAAE,GAAG,EAAE,CAAC,CAAC;AACrE;;;;"}